(window.webpackJsonp=window.webpackJsonp||[]).push([[184],{254:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return p}));var a=n(3),r=n(7),i=(n(0),n(549)),o={title:"Template Comparison"},l={unversionedId:"database/data-integrity-checks/template-comparison",id:"database/data-integrity-checks/template-comparison",isDocsHomePage:!1,title:"Template Comparison",description:"We have written a script that runs queries against the templates publicly available in a mine or a pair of mines. The purpose of these scripts is to:",source:"@site/docs/database/data-integrity-checks/template-comparison.md",slug:"/database/data-integrity-checks/template-comparison",permalink:"/im-docs/docs/next/database/data-integrity-checks/template-comparison",editUrl:"https://github.com/intermine/im-docs/edit/master/docs/database/data-integrity-checks/template-comparison.md",version:"current",sidebar:"someSidebar",previous:{title:"Debugging",permalink:"/im-docs/docs/next/database/database-building/debugging"},next:{title:"Acceptance Tests",permalink:"/im-docs/docs/next/database/data-integrity-checks/acceptance-tests"}},s=[{value:"Python Script",id:"python-script",children:[{value:"Dependencies",id:"dependencies",children:[]},{value:"Invocation",id:"invocation",children:[]}]},{value:"Results",id:"results",children:[]}],c={toc:s};function p(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"We have written a script that runs queries against the templates publicly available in a mine or a pair of mines. The purpose of these scripts is to:"),Object(i.b)("blockquote",null,Object(i.b)("ul",{parentName:"blockquote"},Object(i.b)("li",{parentName:"ul"},"Test that all templates run."),Object(i.b)("li",{parentName:"ul"},"In the case of multiple mines, check that updates haven't radically changed the results."))),Object(i.b)("p",null,"The script presents their results on standard out, with the option to have them emailed upon completion of the comparison. To have results emailed out, you should have set up and installed ",Object(i.b)("inlineCode",{parentName:"p"},"sendmail")," on the machine running the comparison."),Object(i.b)("p",null,"The script is located here: ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/intermine/intermine-release-scripts/blob/master/compare_templates_for_releases.py"}),"https://github.com/intermine/intermine-release-scripts/blob/master/compare","_","templates","_","for","_","releases.py")),Object(i.b)("h2",{id:"python-script"},"Python Script"),Object(i.b)("h3",{id:"dependencies"},"Dependencies"),Object(i.b)("p",null,"This script will run on ",Object(i.b)("inlineCode",{parentName:"p"},"cPython")," 2.5-2.7, ",Object(i.b)("inlineCode",{parentName:"p"},"pypy")," and ",Object(i.b)("inlineCode",{parentName:"p"},"jython"),". It requires the installation of the intermine client module, which can be installed from ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"http://pypi.python.org"}),"PyPi")," with the following command:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ sudo easy_install intermine\n")),Object(i.b)("h3",{id:"invocation"},"Invocation"),Object(i.b)("p",null,"The script can be invoked most simply against a single mine as follows:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ python compare_templates_for_releases.py www.flymine.org/flymine\n")),Object(i.b)("p",null,"To have results emailed, add your email address:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ python compare_templates_for_releases.py www.flymine.org/flymine you@your.host.org\n")),Object(i.b)("p",null,"Optionally set a ''from'' address:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ python compare_templates_for_releases.py www.flymine.org/flymine you@your.host.org noreply@blackhole.net\n")),Object(i.b)("p",null,"Comparing against two mines is same as above, except you simply need to add a second service location:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"python compare_templates_for_releases.py www.flymine.org/flymine beta.flymine.org/beta you@your.host.org\n")),Object(i.b)("h2",{id:"results"},"Results"),Object(i.b)("p",null,"The resulting email will look like this:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-text"}),"-----------------------------------In Both: Diff >= 10%\nBDGP_Gene                                         release-beta:     260, release-28.0:      62, diff:  76%\nChromLocation_CRMOverlappingTFBindingsite         release-beta:      42, release-28.0:     213, diff:  80%\n\n----------------------------------------------------------------------\n-----------------------------------Only in 28.0:\nChromosomeLocation_Tiffin                               8\nDisease_GeneOrthologue                                363\nESTclone_LocationOverlappingGeneOrthologue_new         93\nESTclone_LocationOverlappingGeneStructure               4\nGene_Inparalogue                                       11\nGene_Tiffin                                           156\nProbe_Gene                                              1\nTiffinBSmotif_expressionTerm                           49\nTiffinBSmotif_genes                                  1356\nTiffinBSmotif_locations                                23\n----------------------------------------------------------------------\n-----------------------------------Only in beta:\nAmplicon_RNAiResults                                   39\nGene_AdjacentGene_FlyAtlas_downstream                   0\nGene_OverlapppingGenes                                  1\nGenes_Publications                                 126002\nOrganism_interologs                                   278\n--------------------------------------------------In Both: Diff < 10%\nAll_Genes_In_Organism_To_Publications             release-beta:  126002, release-28.0:  121503, diff:   4%\nAlleleClass_Allele                                release-beta:    2132, release-28.0:    2117, diff:   1%\n")),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"'''In Both: Diff ",">","= 10%''' - templates run in both mines and result counts returned were very different."),Object(i.b)("li",{parentName:"ol"},"'''Only in''' - template was found in one mine and not the other."),Object(i.b)("li",{parentName:"ol"},"'''In Both: Diff ","<"," 10%''' - template run in both mines and results returned were different. It's probably safe to assume these are okay.")))}p.isMDXComponent=!0},549:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=r.a.createContext({}),p=function(e){var t=r.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},b=function(e){var t=p(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),b=p(n),u=a,d=b["".concat(o,".").concat(u)]||b[u]||m[u]||i;return n?r.a.createElement(d,l(l({ref:t},c),{},{components:n})):r.a.createElement(d,l({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);