(window.webpackJsonp=window.webpackJsonp||[]).push([[452],{523:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return p}));var a=n(3),i=n(7),r=(n(0),n(549)),o={title:"publication-search"},l={unversionedId:"embedding/apps-c/publication-search",id:"version-4.0.0/embedding/apps-c/publication-search",isDocsHomePage:!1,title:"publication-search",description:"Note",source:"@site/versioned_docs/version-4.0.0/embedding/apps-c/publication-search.md",slug:"/embedding/apps-c/publication-search",permalink:"/im-docs/docs/4.0.0/embedding/apps-c/publication-search",editUrl:"https://github.com/intermine/im-docs/edit/master/versioned_docs/version-4.0.0/embedding/apps-c/publication-search.md",version:"4.0.0",sidebar:"version-4.0.0/someSidebar",previous:{title:"Apps/C Usage",permalink:"/im-docs/docs/4.0.0/embedding/apps-c/usage"},next:{title:"elastic-med",permalink:"/im-docs/docs/4.0.0/embedding/apps-c/elastic-med"}},s=[{value:"Initialize Project",id:"initialize-project",children:[{value:"Node.js platform",id:"nodejs-platform",children:[]},{value:"Bower vendor dependencies",id:"bower-vendor-dependencies",children:[]},{value:"Grunt building",id:"grunt-building",children:[]}]},{value:"Source files",id:"source-files",children:[{value:"Example page",id:"example-page",children:[]},{value:"App index",id:"app-index",children:[]},{value:"Layout",id:"layout",children:[]},{value:"Search component",id:"search-component",children:[]},{value:"Search template",id:"search-template",children:[]},{value:"Query module",id:"query-module",children:[]},{value:"State module",id:"state-module",children:[]},{value:"IMJS module",id:"imjs-module",children:[]},{value:"Publications list",id:"publications-list",children:[]},{value:"Alert component",id:"alert-component",children:[]},{value:"Alert template",id:"alert-template",children:[]},{value:"Results table component",id:"results-table-component",children:[]},{value:"Results table template",id:"results-table-template",children:[]},{value:"Style",id:"style",children:[]}]},{value:"Fin",id:"fin",children:[]},{value:"Appendix",id:"appendix",children:[{value:"pomme.js",id:"pommejs",children:[]}]}],c={toc:s};function p(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note"),"\nYou can view the source files for this project in the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/intermine/intermine-apps-c/tree/master/publication-search"}),"intermine/intermine-apps-c")," repo."),Object(r.b)("p",null,"This document will guide you through the process of writing a JavaScript client side app ","(","running completely in a browser",")"," using ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://bower.io/"}),"Bower")," and ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://gruntjs.com/"}),"Grunt")," tools. This app will connect to an ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://intermine.org"}),"InterMine")," instance to run a query. The objective will be to fetch a list of publications for each ",Object(r.b)("em",{parentName:"p"},"bio entity")," found that is ",Object(r.b)("em",{parentName:"p"},"like")," our query."),Object(r.b)("p",null,"The libraries we will be using:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"http://bower.io/"}),"Bower")," to fetch vendor dependencies such as JavaScript, CSS or Fonts."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"http://canjs.com/"}),"canJS")," is a framework for client-side development handling routing, events etc."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"http://coffeescript.org/"}),"CoffeeScript")," a language that compiles down to JavaScript and makes writing an app easier."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"http://foundation.zurb.com/"}),"Foundation")," is a CSS framework of reusable UI components."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"http://gruntjs.com/"}),"Grunt")," to build/transpile our source files."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"http://jquery.com/"}),"jQuery")," is a DOM manipulation library ","(","and more",")","."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"http://mustache.github.io/"}),"Mustache")," is a multi-platform templating language allowing us to embed dynamic objects in HTML."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"http://en.wikipedia.org/wiki/Nodejs"}),"Node")," JavaScript desktop software platform."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"http://learnboost.github.io/stylus/"}),"Stylus")," allows us to be more expressive and dynamic with CSS."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"http://lodash.com/"}),"Lodash")," is a utility toolbelt making actions such as iterating over items easier."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/alexkalderimis/imjs"}),"imjs")," used to query InterMines from browser or Node. Saves you having to write raw HTTP requests.")),Object(r.b)("h2",{id:"initialize-project"},"Initialize Project"),Object(r.b)("p",null,"The first step will be to setup our directory structure."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"build/"))),Object(r.b)("p",null,"Will be the directory where our final app package will live. We will develop in languages like ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://learnboost.github.io/stylus/"}),"Stylus")," or ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://coffeescript.org/"}),"CoffeeScript")," and need a way to package all these resources into one whole directory. This is where all these files will live."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"bower_components/"))),Object(r.b)("p",null,"This directory will be automatically created and will contain libraries we have requested through the Bower system."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"example/"))),Object(r.b)("p",null,"Contains an example of our app in use."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"src/"))),Object(r.b)("p",null,"Source files that our code will consist of."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"bower.json"))),Object(r.b)("p",null,"Will contain a listing of libraries we want to download using ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://bower.io/"}),"Bower"),"."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"package.json"))),Object(r.b)("p",null,"Lists libraries we will need to compile and build our app with."),Object(r.b)("h3",{id:"nodejs-platform"},"Node.js platform"),Object(r.b)("p",null,"Since our application is targeting JavaScript in the browser, it is pretty useful if we use JavaScript on our computer ","(","desktop",")"," too. Enter ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://en.wikipedia.org/wiki/Nodejs"}),"Node")," which allows us to execute JavaScript on our computers instead of just our browsers."),Object(r.b)("p",null,"You can fetch ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://nodejs.org/download/"}),"binaries")," from the homepage or use your ","(","hopefully Linux",")"," ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager"}),"packman"),"."),Object(r.b)("p",null,"Once Node is installed, edit the ",Object(r.b)("inlineCode",{parentName:"p"},"package.json")," file like so:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),'{\n    "name": "publication-search",\n    "version": "0.0.0",\n    "devDependencies": {\n        "bower": "~1.2.7",\n        "grunt": "~0.4.1",\n\n        "grunt-apps-c": "0.1.14",\n        "grunt-contrib-concat": "~0.3.0",\n        "grunt-contrib-stylus": "~0.9.0",\n\n        "grunt-contrib-uglify": "~0.2.5",\n        "grunt-contrib-cssmin": "~0.6.2"\n    }\n}\n')),Object(r.b)("p",null,"This file tells Node which libraries will be used to build our app. These are not client-side libraries, but server-side if you will."),Object(r.b)("p",null,"The top bit of the ",Object(r.b)("inlineCode",{parentName:"p"},"devDependencies")," lists a bunch of Grunt and Bower related libraries."),Object(r.b)("p",null,"In order to install all of these, execute the following:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ npm install -d\n")),Object(r.b)("h3",{id:"bower-vendor-dependencies"},"Bower vendor dependencies"),Object(r.b)("p",null,"Now we want to fetch libraries that our app, when running, will depend on."),Object(r.b)("p",null,"Edit the ",Object(r.b)("inlineCode",{parentName:"p"},"bower.json")," file like so:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),'{\n    "name": "publication-search",\n    "version": "0.0.0",\n    "dependencies": {\n        "jquery": "2.0.3",\n        "lodash": "2.4.1",\n        "canjs": "2.0.4",\n        "foundation": "5.0.2",\n        "imjs": "3.2.1"\n    }\n}\n')),Object(r.b)("p",null,"The file has a bunch of key-value pairs."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"name"))),Object(r.b)("p",null,"Name of our application in the Bower ecosystem, required."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"version"))),Object(r.b)("p",null,"Version number in the Bower ecosystem, required."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"dependencies"))),Object(r.b)("p",null,"Lists the actual libraries and their versions to fetch. You can populate this list by executing ",Object(r.b)("inlineCode",{parentName:"p"},"$ bower install jquery --save")," for example. This will download the latest version of the ",Object(r.b)("inlineCode",{parentName:"p"},"jquery")," component into the ",Object(r.b)("inlineCode",{parentName:"p"},"bower_components/")," directory. You can ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://sindresorhus.com/bower-components/"}),"search")," for available components using ",Object(r.b)("inlineCode",{parentName:"p"},"$ bower search jquery"),". To actually trigger a search, execute ",Object(r.b)("inlineCode",{parentName:"p"},"$ bower install"),". The different libraries will be introduced as we code along."),Object(r.b)("h3",{id:"grunt-building"},"Grunt building"),Object(r.b)("p",null,"Grunt is used to munge files together and execute commands on them. Create a file called ",Object(r.b)("inlineCode",{parentName:"p"},"Gruntfile.coffee"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"module.exports = (grunt) ->\n    grunt.initConfig\n        pkg: grunt.file.readJSON(\"package.json\")\n\n        apps_c:\n            commonjs:\n                src: [ 'src/**/*.{coffee,mustache}' ]\n                dest: 'build/js/ps.js'\n                options:\n                    main: 'src/app.coffee'\n                    name: 'ps'\n\n        stylus:\n            compile:\n                src: [ 'src/styles/app.styl' ]\n                dest: 'build/css/ps.css'\n\n        concat:            \n            scripts:\n                src: [\n                    # Vendor dependencies.\n                    'bower_components/jquery/jquery.js'\n                    'bower_components/lodash/dist/lodash.js'\n                    'bower_components/canjs/can.jquery.js'\n                    'bower_components/canjs/can.map.setter.js'\n                    'bower_components/imjs/js/im.js'\n                    # Our app.\n                    'build/js/ps.js'\n                ]\n                dest: 'build/js/ps.bundle.js'\n                options:\n                    separator: ';' # for minification purposes\n\n            styles:\n                src: [\n                    'bower_components/foundation/css/normalize.css'\n                    'bower_components/foundation/css/foundation.css'\n                    # Our app.\n                    'build/css/ps.css'\n                ]\n                dest: 'build/css/ps.bundle.css'\n\n        uglify:\n            scripts:\n                files:\n                    'build/js/ps.min.js': 'build/js/ps.js'\n                    'build/js/ps.bundle.min.js': 'build/js/ps.bundle.js'\n\n        cssmin:\n            combine:\n                files:\n                    'build/css/ps.bundle.min.css': 'build/css/ps.bundle.css'\n                    'build/css/ps.min.css': 'build/css/ps.css'\n\n    grunt.loadNpmTasks('grunt-apps-c')\n    grunt.loadNpmTasks('grunt-contrib-stylus')\n    grunt.loadNpmTasks('grunt-contrib-concat')\n    grunt.loadNpmTasks('grunt-contrib-uglify')\n    grunt.loadNpmTasks('grunt-contrib-cssmin')\n\n    grunt.registerTask('default', [\n        'apps_c'\n        'stylus'\n        'concat'\n    ])\n\n    grunt.registerTask('minify', [\n        'uglify'\n        'cssmin'\n    ])\n")),Object(r.b)("p",null,"This file is written in ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://coffeescript.org/"}),"CoffeeScript")," and lists the tasks to run when we want to build our app. From the top:"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"apps_c"))),Object(r.b)("p",null,"This directive says that we want to take any ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://coffeescript.org/"}),"CoffeeScript")," and ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://mustache.github.io/"}),"Mustache")," files we find in ",Object(r.b)("inlineCode",{parentName:"p"},"src/")," and combine them into one JavaScript package."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"stylus"))),Object(r.b)("p",null,"Take a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://learnboost.github.io/stylus/"}),"Stylus")," file and turn it into CSS."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"concat"))),Object(r.b)("p",null,"Take our vendor files ","(","installed using ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://bower.io/"}),"Bower"),")"," and, together with our app, make them into a bundle. If someone else wants to use our app they need our app and its deps too, so this one file will do it for them. Do the same to CSS too."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"uglify"))),Object(r.b)("p",null,"Minify our built JavaScript files. This makes them small, but unreadable, so not great for debugging."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"cssmin"))),Object(r.b)("p",null,"The same as ",Object(r.b)("inlineCode",{parentName:"p"},"uglify")," but for CSS"),Object(r.b)("p",null,"Then we have two calls to ",Object(r.b)("inlineCode",{parentName:"p"},"grunt.registerTask")," which bundle a bunch of tasks together. For example, running ",Object(r.b)("inlineCode",{parentName:"p"},"$ grunt minify")," will run the ",Object(r.b)("inlineCode",{parentName:"p"},"uglify")," and ",Object(r.b)("inlineCode",{parentName:"p"},"cssmin")," tasks."),Object(r.b)("p",null,"While developing, it is quite useful to watch the source files and re-run the build task like so:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ watch --color grunt\n")),Object(r.b)("p",null,"This will run the default Grunt task every 2s."),Object(r.b)("h2",{id:"source-files"},"Source files"),Object(r.b)("h3",{id:"example-page"},"Example page"),Object(r.b)("p",null,"One needs an access point where our app will get loaded with particular configuration. This is where the ",Object(r.b)("inlineCode",{parentName:"p"},"example/index.html")," comes in:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-markup"}),'<!doctype html>\n<html>\n<head>\n    <meta charset="utf-8">\n    <title>Publication Search</title>\n\n    <link href="build/css/ps.bundle.css" media="all" rel="stylesheet" type="text/css" />\n    <script src="build/js/ps.bundle.js"><\/script>\n</head>\n<body>\n    <div id="app"></div>\n    <script>\n        // Once scripts have loaded.\n        $(function() {\n            // ...show the app.\n            require(\'ps\')({\n                \'el\':   \'#app\',\n                \'mine\': \'http://www.mousemine.org/mousemine\'\n            });\n        });\n    <\/script>\n</body>\n</html>\n')),Object(r.b)("p",null,"This file does not do anything else other then load our built CSS and JS files and starts our app once the page loads. In our example, we are pointing to a ",Object(r.b)("inlineCode",{parentName:"p"},"build")," directory relative to the ",Object(r.b)("inlineCode",{parentName:"p"},"example")," directory. So let's make a symbolic link to the actual ",Object(r.b)("inlineCode",{parentName:"p"},"build"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ ln -s ../build build/\n")),Object(r.b)("p",null,"Such links get preserved when version controlling using ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://git-scm.com/"}),"Git"),". We are linking to our bundled builds that contain vendor dependencies too."),Object(r.b)("p",null,"Then we are waiting for the page to load and call our ","(","future",")"," app with some config."),Object(r.b)("p",null,"The name ",Object(r.b)("inlineCode",{parentName:"p"},"ps")," is being configured in the ",Object(r.b)("inlineCode",{parentName:"p"},"Gruntfile.coffee")," file in the ",Object(r.b)("inlineCode",{parentName:"p"},"apps-c")," task."),Object(r.b)("p",null,"As for the config:"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"el"))),Object(r.b)("p",null,"Selector where our app should be displayed."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"mine"))),Object(r.b)("p",null,"Points to an ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://intermine.org"}),"InterMine"),"."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"require")," call relates to ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://addyosmani.com/writing-modular-js/"}),"CommonJS"),". It is one way of loading JavaScript modules. It avoids having to expose all of our functions and objects on the global ","(",Object(r.b)("inlineCode",{parentName:"p"},"window"),")"," object and implements a way of relating between different files. For example, to load a module on the same ",Object(r.b)("em",{parentName:"p"},"directory")," level as me:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"require './module'\n")),Object(r.b)("h3",{id:"app-index"},"App index"),Object(r.b)("p",null,"We have asked to load an app in our ",Object(r.b)("inlineCode",{parentName:"p"},"example/index.html")," page, now we are going to write the backing code."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"apps-c")," task ","(","in ",Object(r.b)("inlineCode",{parentName:"p"},"Gruntfile.coffee"),")"," contains the following two options:"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"name"))),Object(r.b)("p",null,"How do we call our app for ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://addyosmani.com/writing-modular-js/"}),"CommonJS")," ",Object(r.b)("inlineCode",{parentName:"p"},"require")," call?"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"main"))),Object(r.b)("p",null,"Contains a path ","(","an index",")"," that will be called when we actually call the ",Object(r.b)("inlineCode",{parentName:"p"},"require")," function."),Object(r.b)("p",null,"We have specified that our app index lives in ",Object(r.b)("inlineCode",{parentName:"p"},"src/app.coffee"),", so let's create this file:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"render  = require './modules/render'\nquery   = require './modules/query'\nimjs    = require './modules/imjs'\nstate   = require './modules/state'\n\nlayout  = require './templates/layout'\n\ncomponents = [\n    'alert'\n    'search'\n    'table'\n]\n\nmodule.exports = (opts) ->\n    # Load the components.\n    ( require \"./components/#{name}\" for name in components )\n\n    # Setup the UI.\n    $(opts.el).html render layout\n\n    # Do we have mine set?\n    return state.attr { 'type': 'warning', 'text': 'Mine is not set' } unless opts.mine\n\n    # Setup the client.\n    imjs.attr { 'client': new intermine.Service 'root': opts.mine }\n\n    # Manually change the query to init the search?\n    query(q) if q = opts.symbol\n")),Object(r.b)("p",null,"Each module ","(","file",")"," in our app needs to export some functionality. When we call ",Object(r.b)("inlineCode",{parentName:"p"},"require"),", we will be getting this functionality."),Object(r.b)("h4",{id:"observable"},"Observable"),Object(r.b)("p",null,"We are going to be using ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/"}),"canJS")," which gives us objects that can be ",Object(r.b)("em",{parentName:"p"},"observed"),". What this means is that when their values change, others listening to these changes will be notified. When we want to ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.Map.prototype.attr.html"}),"change")," their value we call ",Object(r.b)("inlineCode",{parentName:"p"},"attr")," function on them. One such example is where we setup the client. We are passing an object which is set on ",Object(r.b)("inlineCode",{parentName:"p"},"imjs"),",a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.Map.html"}),"canMap"),". Or the line below where we set a symbol on a ",Object(r.b)("inlineCode",{parentName:"p"},"query")," which is a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.compute.html"}),"canCompute"),". The advantage here is that whenever we set a new symbol on ",Object(r.b)("inlineCode",{parentName:"p"},"query"),", anyone else will be told it has changed and do something. This something means to trigger a search."),Object(r.b)("h4",{id:"components"},"Components"),Object(r.b)("p",null,"But first, we are require some components in the memory. These are ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.Component.html"}),"canComponent")," instances. They wrap some user interface functionality ","(","think widget",")"," and are tied to a DOM tag. Whenever this tag appears on the page, a component gets automatically created with the appropriate template and data. For now, let's just say these need to be loaded before we inject our first template into the page. An example of a tag:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-markup"}),"<app-component></app-component>\n")),Object(r.b)("p",null,"We inject the said template, layout, on the line below. Layout will represent the HTML that is true for our app/page. It will have custom tags in it that automatically get rendered as components ","(","as above",")","."),Object(r.b)("h3",{id:"layout"},"Layout"),Object(r.b)("p",null,"Let us take a look at the layout template then; in ",Object(r.b)("inlineCode",{parentName:"p"},"/src/templates/layout.mustache"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-text"}),'<div class="row collapse">\n    <div class="small-2 columns">\n        <span class="prefix">Search:</span>\n    </div>\n    <div class="small-10 columns">\n        <app-search></app-search>\n    </div>\n</div>\n\n<div class="row collapse">\n    <div class="small-12 columns">\n        <app-alert></app-alert>\n    </div>\n</div>\n\n<div class="row collapse">\n    <div class="small-12 columns">\n        <app-table></app-table>\n    </div>\n</div>\n')),Object(r.b)("p",null,"Our app will consist of 3 components:"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"app-search"))),Object(r.b)("p",null,"A component that will represent our input search field."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"app-alert"))),Object(r.b)("p",null,"An alert message showing what state the app is in."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"app-table"))),Object(r.b)("p",null,"A table with results of our search."),Object(r.b)("h3",{id:"search-component"},"Search component"),Object(r.b)("p",null,"The search component will bind the ",Object(r.b)("inlineCode",{parentName:"p"},"query")," to our input field; in ",Object(r.b)("inlineCode",{parentName:"p"},"/src/components/search.coffee"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"query = require '../modules/query'\n\n# Search form.\nmodule.exports = can.Component.extend\n\n    tag: 'app-search'\n\n    template: require '../templates/search'\n\n    scope: -> { 'query': { 'value': query } }\n\n    events:\n        'input keyup': (el, evt) ->\n            if (evt.keyCode or evt.which) is 13\n                query do el.val\n")),Object(r.b)("p",null,"To do so, we require the ",Object(r.b)("inlineCode",{parentName:"p"},"query")," module. It is the same module we have seen in our app index. And then, we are off using the standard ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.Component.html"}),"canComponent")," notation. There is:"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"tag"))),Object(r.b)("p",null,"Which is the custom DOM tag/element for this component. Again, if this tag appears on the page, this component will spring to life."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"template"))),Object(r.b)("p",null,"This is the template that will get injected into the ",Object(r.b)("inlineCode",{parentName:"p"},"tag"),"."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"scope"))),Object(r.b)("p",null,"Ah, the magic. You can either pass in an object of key-value pairs that will be accessible within our ",Object(r.b)("inlineCode",{parentName:"p"},"template"),". A more interesting approach is to return a function that returns said object. Doing so will make this component listen in on any changes in the object. In our example, we are ","(","using slightly convoluted notation",")"," listening to changes to ",Object(r.b)("inlineCode",{parentName:"p"},"query"),", which is a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.compute.html"}),"canCompute"),"."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"events"))),Object(r.b)("p",null,"Makes this component listen to events in the template and then do something. The syntax is ",Object(r.b)("inlineCode",{parentName:"p"},"<event>"),". In our example, whenever the user has pressed ","(","and raised their finger",")"," from a key on a keyboard, we call a function. This function checks that the key was ",Object(r.b)("inlineCode",{parentName:"p"},"Enter")," and updates the ",Object(r.b)("inlineCode",{parentName:"p"},"query"),"."),Object(r.b)("h3",{id:"search-template"},"Search template"),Object(r.b)("p",null,"The search template just outputs the current value of the query:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-text"}),'<input type="text" placeholder="e.g. brca, gamma" value="{{ query.value }}" autofocus>\n')),Object(r.b)("p",null,"We are also giving this field the focus on the page so a user can just start typing."),Object(r.b)("h3",{id:"query-module"},"Query module"),Object(r.b)("p",null,"We have been talking about this ",Object(r.b)("inlineCode",{parentName:"p"},"query")," for a while, it is time to write its code; in ",Object(r.b)("inlineCode",{parentName:"p"},"/src/modules/query.coffee"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"pubs  = require './pubs'\nimjs  = require './imjs'\nstate = require './state'\n\n# The default search query.\nquery = can.compute ''\n\n# Keep track of requests.\ngid = 0\n\n# Observe query changes to trigger a service search.\nquery.bind 'change', (ev, q) ->\n    state.attr { 'type': 'info', 'text': 'Searching &hellip;' }\n    id = ++gid\n\n    imjs.search q, (err, res) ->\n        # Too late?\n        return if id < gid\n        return state.attr { 'type': 'warning', 'Oops &hellip' } if err\n        state.attr { 'type': 'success', 'text': \"Found #{res.length} results\" }\n        pubs.replace res\n\nmodule.exports = query\n")),Object(r.b)("p",null,"First we require some other modules:"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"pubs"))),Object(r.b)("p",null,"Will represent our results collection/list."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"imjs"))),Object(r.b)("p",null,"A module doing the actual search."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},Object(r.b)("inlineCode",{parentName:"strong"},"state"))),Object(r.b)("p",null,"Will be told what the state of the app is (for alerts)."),Object(r.b)("p",null,"We initialize the query to be empty using ",Object(r.b)("inlineCode",{parentName:"p"},"''"),". If a developer wants to pass an initial query, we have seen the relevant code in app index."),Object(r.b)("p",null,"Then we have a function that listens in on our changes. Whenever query changes, this function is triggered. We use it to first say that we are starting a search. Then we actually call the ",Object(r.b)("inlineCode",{parentName:"p"},"imjs")," module to do the search. If all went fine, we inject the new results into the ",Object(r.b)("inlineCode",{parentName:"p"},"pubs")," module."),Object(r.b)("p",null,"There are two things that could go wrong:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"The search might not be successfull ","(","mine down, malformed query etc.",")"),Object(r.b)("li",{parentName:"ol"},"The results may arrive too late, such as when the user sees the first set of results after asking for another set of results.")),Object(r.b)("p",null,"Both cases are handled."),Object(r.b)("h3",{id:"state-module"},"State module"),Object(r.b)("p",null,"Is a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.Map.html"}),"canMap")," that keeps track of the app state; it lives in ",Object(r.b)("inlineCode",{parentName:"p"},"/src/modules/state.coffee"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"module.exports = new can.Map\n    'type': 'info'\n    'text': 'Search is ready'\n")),Object(r.b)("p",null,"The map has two attributes, one for a type of state we are in ",Object(r.b)("inlineCode",{parentName:"p"},"[ info|success|warning ]")," and the other for the actual message."),Object(r.b)("h3",{id:"imjs-module"},"IMJS module"),Object(r.b)("p",null,"This module will do the actual search on the mine. It is called imjs since it is going to be using the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/alexkalderimis/imjs"}),"imjs")," library behind the scenes. We will find it in ",Object(r.b)("inlineCode",{parentName:"p"},"/src/modules/imjs.coffee"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"query =\n    'select': [\n        'Publication.title'\n        'Publication.year'\n        'Publication.journal'\n        'Publication.pubMedId'\n        'Publication.authors.name'\n        'Publication.bioEntities.symbol'\n        'Publication.bioEntities.id'\n    ]\n    'orderBy': [\n        { 'Publication.title': 'ASC' }\n    ]\n    'joins': [\n        'Publication.authors'\n    ]\n\nmodule.exports = new can.Map\n\n    # Needs to be initialized.\n    client: null\n\n    # Search publications by bio entity symbol.\n    search: (symbol, cb) ->\n        return cb 'Client is not setup' unless @client\n\n        @client.query _.extend({}, query, {\n            'where': [\n                {\n                    'path': 'Publication.bioEntities.symbol'\n                    'op':   'CONTAINS'\n                    'value': symbol\n                }\n            ]\n        }), (err, q) ->\n            return cb err if err\n            # Run the query.\n            q.tableRows (err, res) ->\n                return cb err if err\n\n                # Re-map to a useful format.\n                remap = (rows) ->\n                    type = null\n                    _.extend _.zipObject(_.map rows, (row) ->\n                        # Add our type.\n                        type = row.class if row.column is 'Publication.bioEntities.id'\n                        # Tuple of column - value.\n                        [\n                            row.column.split('.').pop()\n                            if row.rows then _.map(row.rows, remap) else row.value\n                        ]\n                    ), { type }\n\n                cb null, _.map res, remap\n")),Object(r.b)("p",null,"At the top, we are defining the query that will be used to run the query. The format is that of an InterMine PathQuery. You can see ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/alexkalderimis/imjs"}),"imjs")," for syntax and more information. One can generate this syntax by visiting the mine in question, running a query in QueryBuilder and then choosing to export to JavaScript in the Results Table."),Object(r.b)("p",null,"Our query will be looking for publications, fetching their bio entities ","(","genes, alleles, proteins etc.",")"," and authors. Authors is a separate collection mapped to a publication."),Object(r.b)("p",null,"Then we are using the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.Map.html"}),"canMap")," syntax to define a ",Object(r.b)("inlineCode",{parentName:"p"},"client")," attribute and a ",Object(r.b)("inlineCode",{parentName:"p"},"search")," function. An object can have both attributes and functions defined."),Object(r.b)("p",null,"We took care of initializing the ",Object(r.b)("inlineCode",{parentName:"p"},"client")," in app index. In that step, we were intializing the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/alexkalderimis/imjs"}),"imjs")," library to use a specific mine, MouseMine in our case."),Object(r.b)("p",null,"The search function takes two parameters, a symbol and a callback. The first is the search symbol coming from ",Object(r.b)("inlineCode",{parentName:"p"},"query")," module, the second, a function that will be called when we have errors or results. Hopefully the latter."),Object(r.b)("p",null,"We are then using ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/alexkalderimis/imjs"}),"imjs")," syntax to extend our ",Object(r.b)("inlineCode",{parentName:"p"},"query")," with a constraint on a bio entity symbol, matching our symbol and returning ",Object(r.b)("inlineCode",{parentName:"p"},"tableRows"),"."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"remap")," function is just formatting the results into a format that is useful to us. In our case, we want to have the following data structure which is conducive to being traversed in a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://mustache.github.io/"}),"Mustache")," template:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),'[\n    {\n        "title": "Distinct negative regulatory mechanisms involved in the repression of human embryonic epsilon- and fetal G gamma-globin genes in transgenic mice.",\n        "year": 1994,\n        "journal": "J Biol Chem",\n        "pubMedId": "7806539",\n        "authors": [\n            {\n                "name": "Perez-Stable C",\n                "type": null\n            }\n        ],\n        "symbol": "Tg(Ggamma-T)15Cps",\n        "id": 1678446,\n        "type": "Transgene"\n    }\n]\n')),Object(r.b)("p",null,"We are extracting the type of the bio entity matched and creating a nested ",Object(r.b)("inlineCode",{parentName:"p"},"authors")," field."),Object(r.b)("p",null,"Once we have the new data we are calling back using the ",Object(r.b)("inlineCode",{parentName:"p"},"cb")," function, it is customary to specify an error as the first argument into said function. Since all is well, we are passing a ",Object(r.b)("inlineCode",{parentName:"p"},"null")," value."),Object(r.b)("h3",{id:"publications-list"},"Publications list"),Object(r.b)("p",null,"We still have one module to cover. This is the ",Object(r.b)("inlineCode",{parentName:"p"},"pubs")," we have referred to elsewhere; in ",Object(r.b)("inlineCode",{parentName:"p"},"/src/modules/pubs.coffee"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"module.exports = new can.List []\n")),Object(r.b)("p",null,"We are using the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.List.html"}),"canList")," object to store an observable array of values. To be honest, we don't need to use an observable object here, but you may want to, if you are going to be changing values in the array rather than replacing the whole thing outright."),Object(r.b)("h3",{id:"alert-component"},"Alert component"),Object(r.b)("p",null,"When doing our searches we have decided to keep track of the state of the application. Are we searching? Do we have errors? That sort of thing."),Object(r.b)("p",null,"We already wrote a module, a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.Map.html"}),"canMap"),", to represent the data structure. Now we just need to write the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.Component.html"}),"canComponent")," for it."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"state = require '../modules/state'\n\n# An alert.\nmodule.exports = can.Component.extend\n\n    tag: 'app-alert'\n\n    template: require '../templates/alert'\n\n    scope: -> state\n")),Object(r.b)("p",null,"What it does is that it shows up when ",Object(r.b)("inlineCode",{parentName:"p"},"app-alert")," appears and then displays a template and observes when ",Object(r.b)("inlineCode",{parentName:"p"},"state")," changes."),Object(r.b)("h3",{id:"alert-template"},"Alert template"),Object(r.b)("p",null,"Each component needs a template. The alert one will look like this:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-text"}),'<div class="alert-box {{ type }}">\n    {{{ text }}}.\n</div>\n')),Object(r.b)("p",null,"What we are saying here is to display a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://foundation.zurb.com/"}),"Foundation")," alert box with a custom type and a text. We use ",Object(r.b)("inlineCode",{parentName:"p"},"{{{ }}}")," to display the text which allows us to use HTML in the ",Object(r.b)("inlineCode",{parentName:"p"},"text")," string and have it unescaped."),Object(r.b)("h3",{id:"results-table-component"},"Results table component"),Object(r.b)("p",null,"Now that we are searching for and updating ",Object(r.b)("inlineCode",{parentName:"p"},"pubs")," with new data, we have to observe them in a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://canjs.com/docs/can.Component.html"}),"canComponent")," and render them. It lives in ",Object(r.b)("inlineCode",{parentName:"p"},"/src/components/table.coffee"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"pubs = require '../modules/pubs'\n\n# Table of publication results.\nmodule.exports = can.Component.extend\n\n    tag: 'app-table'\n\n    template: require '../templates/table'\n\n    scope: -> { pubs }\n")),Object(r.b)("p",null,"This will make an array of publications available to us in a template under the ",Object(r.b)("inlineCode",{parentName:"p"},"pubs")," key."),Object(r.b)("h3",{id:"results-table-template"},"Results table template"),Object(r.b)("p",null,"As for the template that displays the results; in ",Object(r.b)("inlineCode",{parentName:"p"},"/src/templates/table.mustache"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-text"}),'{{ #if pubs.length }}\n<table>\n    <thead>\n        <tr>\n            <th>Title</th>\n            <th>Author(s)</th>\n            <th>Journal</th>\n            <th>Year</th>\n            <th>Match</th>\n        </tr>\n    </thead>\n    <tbody>\n    {{ #pubs }}\n        <tr>\n            <td class="title">\n                <a target="_{{ pubMedId }}" href="http://www.ncbi.nlm.nih.gov/pubmed/{{ pubMedId }}">{{ title }}</a>\n            </td>\n            <td>\n            {{ #authors }}\n                <span class="author">{{ name }}</span>\n            {{ /authors }}\n            </td>\n            <td>{{ journal }}</td>\n            <td>{{ year }}</td>\n            <td class="nowrap">\n                <a target="_{{ id }}" href="http://www.mousemine.org/mousemine/report.do?id={{ id }}">\n                    {{ symbol }}\n                </a>\n                <span class="label">{{ type }}</span>\n            </td>\n        </tr>\n    {{ /pubs }}\n    </tbody>\n</table>\n{{ /if }}\n')),Object(r.b)("p",null,"Firstly, we are checking if we actually have any results to speak of. If so, we render a table ","<","tr/",">"," element for each publication."),Object(r.b)("p",null,"We can see that ",Object(r.b)("inlineCode",{parentName:"p"},"{{  #pubs  }}")," and ",Object(r.b)("inlineCode",{parentName:"p"},"{{  #authors  }}")," both represent a for loop."),Object(r.b)("h3",{id:"style"},"Style"),Object(r.b)("p",null,"We are going to wrap up by writing a stylesheet. For this, we are going to use ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://learnboost.github.io/stylus/"}),"Stylus"),"; in ",Object(r.b)("inlineCode",{parentName:"p"},"/src/styles/app.styl"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-text"}),"@import 'nib'\n\nbody\n    padding: 20px\n\ntable\n    width: 100%\n\n    td\n        .author\n            &:not(:last-child)\n                &:after\n                    content: \", \"\n                    display: inline-block\n\n        .label\n            padding: 0 4px\n            line-height: 16px\n\n        &.title\n            width: 40%\n\n        &.nowrap\n            white-space: nowrap\n")),Object(r.b)("p",null,"Stylus allows us to write nested rules, such as when we want to select a table cell, ",Object(r.b)("inlineCode",{parentName:"p"},"<td/>")," in a ",Object(r.b)("inlineCode",{parentName:"p"},"<table/>"),"."),Object(r.b)("p",null,"At the top, we can see a reference to ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://stylus.github.io/nib/"}),"nib"),". This will make any of our rules to be generated with browser vendor prefixed, where appropriate and allows us to use shorthand notation for various oft repeated rules."),Object(r.b)("h2",{id:"fin"},"Fin"),Object(r.b)("p",null,"This concludes our application. Running a static web server to view the ",Object(r.b)("inlineCode",{parentName:"p"},"/example")," folder, we are presented with a page that displays our app. Typing a symbol into the input box and pressing ",Object(r.b)("inlineCode",{parentName:"p"},"Enter")," launches a request against MouseMine and if successful, shows us results."),Object(r.b)("h2",{id:"appendix"},"Appendix"),Object(r.b)("h3",{id:"pommejs"},"pomme.js"),Object(r.b)("p",null,"What we have not covered is the case when we want to embed our app beside other apps on a page. If that were the case, all our CSS rules would start conflicting with other rules on the page. Not to speak of canComponents that may pop up in all kinds of places if we are using the same tags across different apps."),Object(r.b)("p",null,"One way to deal with this issue is to make use of the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/radekstepan/pomme.js"}),"pommejs")," library. What it does is create a sandbox ","(","using an ",Object(r.b)("inlineCode",{parentName:"p"},"<iframe/>"),")"," which is isolated from anything else on the page. One would load an app inside one such sandbox and not have to worry about library collusion."),Object(r.b)("p",null,"For example, we would create a pure ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/radekstepan/pomme.js"}),"pommejs")," ",Object(r.b)("em",{parentName:"p"},"build")," in ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://gruntjs.com/"}),"Grunt"),". In ",Object(r.b)("inlineCode",{parentName:"p"},"Gruntfile.coffee"),", add the following task:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-coffeescript"}),"copy:\n    pomme:\n        src: [ 'bower_components/pomme.js/build/app.bundle.js' ]\n        dest: 'build/js/pomme.bundle.js'\n        expand: yes\n        flatten: yes\n\ngrunt.loadNpmTasks('grunt-contrib-copy')\n")),Object(r.b)("p",null,"This requires you to have the following task installed:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ npm install grunt-contrib-copy\n")),Object(r.b)("p",null,"In order to download the library itself using ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://bower.io/"}),"Bower"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ bower install pomme.js\n")),Object(r.b)("p",null,"Now, we are copying a bundled version of ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/radekstepan/pomme.js"}),"pommejs")," into our build directory."),Object(r.b)("p",null,"To create this sandbox, we are going to require ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/radekstepan/pomme.js"}),"pommejs")," instead; in ",Object(r.b)("inlineCode",{parentName:"p"},"/example/index.html"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-markup"}),"<!doctype html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>Publication Search</title>\n\n    <script src=\"build/js/pomme.bundle.js\"><\/script>\n</head>\n<body>\n    <div id=\"app\"></div>\n    <script>\n        // Once scripts have loaded.\n        $(function() {\n            var Pomme = require('pomme.js');\n            var channel = new Pomme({\n                'target': '#app',\n                'template': function() {\n                    return '<MY TEMPLATE HERE>'\n                }\n            });\n        });\n    <\/script>\n</body>\n</html>\n")),Object(r.b)("p",null,"In the section above, we can see a placeholder for a template. In that place we need to return a string which will correspond to the html that needs to be executed within the sandbox. It should look something like this ","(","but as a string!",")",":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-markup"}),'<!doctype html>\n<html>\n<head>\n    <meta charset="utf-8">\n    <title>Publication Search</title>\n\n    <link href="build/css/ps.bundle.css" media="all" rel="stylesheet" type="text/css" />\n    <script src="build/js/ps.bundle.js"><\/script>\n</head>\n<body>\n    <div id="app"></div>\n    <script>\n        // Once scripts have loaded.\n        $(function() {\n            // ...show the app.\n            require(\'ps\')({\n                \'el\':   \'#app\',\n                \'mine\': \'http://www.mousemine.org/mousemine\'\n            });\n        });\n    <\/script>\n</body>\n</html>\n')),Object(r.b)("p",null,"So our example ",Object(r.b)("inlineCode",{parentName:"p"},"index.html")," has moved into a string and is being executed inside an iframe."),Object(r.b)("p",null,"Refer to the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/radekstepan/pomme.js"}),"pommejs")," documentation if you'd like to know how to open a two way communication channel between the parent page and the iframe window."))}p.isMDXComponent=!0},549:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return d}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=i.a.createContext({}),p=function(e){var t=i.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},b=function(e){var t=p(e.components);return i.a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},m=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),b=p(n),m=a,d=b["".concat(o,".").concat(m)]||b[m]||u[m]||r;return n?i.a.createElement(d,l(l({ref:t},c),{},{components:n})):i.a.createElement(d,l({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var c=2;c<r;c++)o[c]=n[c];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);